icon:fontawesome/solid/unlock-keyhole

# CVE-2014-6321

CVE-2014-6321 | MS14-066

Schannel in Microsoft Windows Server 2003 SP2, Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8, Windows 8.1, Windows Server 2012 Gold and R2, and Windows RT Gold and 8.1 allows remote attackers to execute arbitrary code via crafted packets, aka "Microsoft Schannel Remote Code Execution Vulnerability."

## Installation

- [winshock_test.sh](../assets/files/winshock_test.sh)

## Usage

```bash
./winshock_test.sh 10.0.0.1 3389
./winshock_test.sh 10.0.0.2 443
```

## Examples

```bash
./winshock_test.sh 10.10.10.16 3389

Checking if script is up-to-date...
Script is up-to-date.
[...]
Testing if OpenSSL supports the ciphers we are checking for: YES

Testing 10.10.10.16:3389 for availability of SSL ciphers added in MS14-066...
Testing cipher DHE-RSA-AES256-GCM-SHA384:   UNSUPPORTED
Testing cipher DHE-RSA-AES128-GCM-SHA256:   UNSUPPORTED
Testing cipher AES256-GCM-SHA384:           UNSUPPORTED
Testing cipher AES128-GCM-SHA256:           UNSUPPORTED

Checking if target system is running Windows Server 2012 or later...
Testing cipher ECDHE-RSA-AES256-SHA384:     UNSUPPORTED
Testing cipher ECDHE-RSA-AES256-SHA:        UNSUPPORTED

10.10.10.16:3389 is patched: NO
[...]
```

## References

- [GitHub](https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS14-066)
- [Microsoft Security Update KB2992611](https://www.catalog.update.microsoft.com/Search.aspx?q=2992611)
- [Docs.microsoft.com](https://docs.microsoft.com/en-us/security-updates/securitybulletins/2014/ms14-066)
